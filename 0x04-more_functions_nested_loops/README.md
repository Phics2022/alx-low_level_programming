more nested loops and fi=unctions
